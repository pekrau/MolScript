<html>
<head>
<title>MolScript v2.1: Input file</title>
<link href="style.css" type="text/css" rel="stylesheet"></link>
</head>

<body>

<h1 align=center>Input file: plots</h1>

<ul>
<li><a href="#general">General syntax rules</a>
<li><a href="#plot">plot... end_plot</a>
<li><a href="#title">title</a>
<li><a href="#stream">Input streams</a>
<li><a href="#macros">Macros</a>
</ul>

<hr>
<h2><a name="general">General syntax rules</a></h2>

<ul>
<li>
The input file is free-format; white-space characters (space, newline
and tab) can be used freely. Items such as keywords and explicit
values must be separated by at least one white-space character.
<li>
Comments begin with an exclamation-mark '!' and continue until the
end-of-line. Comments are skipped by MolScript and have no effect.
<li>
Input lines can be any length. Single items (keywords, strings) can be
at most 2047 characters long. Quoted strings (delimited by the
'&quot;' character) must be finished on the same line. A quoted string
cannot contain a newline character.
<li>
The semi-colon character ';' is used as a command terminator in
MolScript. All commands end with this character.
<li>
No keywords can be abbreviated, they must be spelled correctly, and
must be in the correct character case (<i>i.e.</i>
<a href="residue_commands.html#trace">trace</a> is a
valid command, while Trace is not). 
</ul>
<p>
In the previous versions of MolScript (v1.4 and older) an integer
could not be used when a floating-point value was specified, and vice 
versa. This restriction has been
<a href="values.html#number">removed</a>.
<p>
<strong>Note</strong> that the keywords <strong>encapsulated</strong>
and <strong>raster3d</strong>, which in previous versions of MolScript
(v1.4 and older) could be used before the first plot, are no longer
valid. The choice of output mode now has to be made by supplying the
proper <a href="use.html#options">command-line option</a>. 
<p>
A parser generated by the yacc program
(<a href="references.html#Levine-1992">Levine <i>et al.</i>, 1992</a>)
from the molscript.y file is used to process the input file in
MolScript. 
<p>

<hr>
<h2><a name="plot">plot... end_plot</a></h2>

An image is specified by the commands given between the
<strong>plot</strong> and <strong>end_plot</strong> keywords. See the
<a href="use.html#minimal">minimal input file</a> for an example. The
only items that may appear outside of these keywords are the
<a href="#title">title</a> item and the <a href="#macros">macro
definitions</a>. 
<p>
Conceptually, the commands within the
<strong>plot... end_plot</strong> keywords are grouped into two
sections:
<ol>
<li><a href="header.html">The header commands</a>
<li>The general commands
</ol>
<a href="header.html">The header commands</a> define some overall
characteristics of the image, and can be given only at the top of the
plot specification. The general commands include all
<a href="coordinates.html">coordinate handling commands</a>, the
<a href="commands.html">graphics commands</a> and the graphics state
change commands <a href="state.html">set, push and pop</a>. The
general commands may occur in any order after the header commands.
<p>
For the <a href="output.html#PostScript">PostScript</a> output mode,
more than one <strong>plot... end_plot</strong> blocks are allowed in one
input file, which results in more than one image on the paper. The
header command <a href="header.html#area">area</a> must be used in
this case to specify where on place the images on the paper, or else
the last image will simply obliterate the previous ones.
<p>

<hr>
<h2>
<a name="title">title</a>
<a href="values.html#string"><i>string</i></a>
</h2>

Output a title to the plot. The actual effect depends on the output mode:
<ul>
<li> <a href="output.html#PostScript">PostScript</a>: A title comment
is written in the file, which has no effect on the printed image.
<li> <a href="output.html#VRML">VRML 2.0</a>: The title string in the
WorldInfo node is set, which may or may not have a visible effect
depending on the VRML browser.
<li> <a href="output.html#OpenGL">OpenGL</a>: The title is used as the
name for the display window.
<li> There is no effect at all for the
<a href="output.html#Raster3D">Raster3D</a> or
<a href="output.html#image">image file</a> modes.
</ul>
<strong>Note</strong> that this item must be given
<strong>before</strong> the first <a href="#plot">plot</a> keyword,
and can appear only once in an input file. 
<p>
<strong>Note</strong> that there is no semi-colon ';' after this item.

<p>
<hr>
<h2><a name="stream">Input streams</a></h2>

MolScript initially reads its input from <strong>stdin</strong>
(standard input) or the file specified by the command-line option 
<a href="use.html#options">-in</a>. There is a
mechanism by which the input source can be changed to another
file. This file is read until it has been exhausted, at which point
the reading of the original input file resumes. 
<p>
This change of input stream file is accomplished with the item
<pre>
   @filename
</pre>
where the character '@' indicates that the rest of the item is a file
name.
<p>
<strong>Note</strong> that there is no semi-colon; this input stream
item is not part of the ordinary syntax of the MolScript input
file. Rather, it is a special item that only affects the source of the
input. 
<p>
This facility makes it possible for a complicated image specification
to be split up into several files. For example, if the structure to be
plotted must be composed by several
<a href="coordinates.html#read">read</a>, 
<a href="coordinates.html#copy">copy</a> and
<a href="coordinates.html#delete">delete</a> statements, then this can
be done in a separate file. This file is then referred to using '@'
and the graphics commands given separately afterwards. In this way,
several different input files using the same coordinate setup can be
made easily, with a guarantee that the coordinate sets are identical
in the different images.
<p>
The input stream can be changed in a nested fashion, one file
referring to another, to any depth.
<p>

<hr>
<h2><a name="macros">Macros</a></h2>

A macro is a block of input text that is referenced by a name (or
symbol). In MolScript a macro is defined by the keywords
<strong>macro</strong> and <strong>end_macro</strong>:
<pre>
     macro macroname
        <i>whatever</i>
     end_macro
</pre>
The first item after the <strong>macro</strong> keyword is the macro name
(or symbol).  Everything else between <strong>macro</strong> and
<strong>end_macro</strong> is stored as text, without interpretation. The
text will be interpreted only when and if the macro is called.
<p>
Macro definitions can be placed just before a plot, or as an ordinary
command. A macro definition cannot be placed among the
<a href="header.html">header commands</a>. If placed before a plot,
then there must be no semi-colon ';' after the keyword
<strong>end_macro</strong>. If placed among the ordinary commands, there
must be a semi-colon ';' after the keyword <strong>end_macro</strong>.
The macro definition is kept in memory until the end of execution of
the current input file. It cannot be modified once it has been
created. Macro definitions cannot be recursive.
<p>
A macro is called by giving the macro name preceded by a dollar
character '$'. There must be no blank between the dollar character '$'
and the macro name. That item will be substituted by the contents of
the macro, which will then be interpreted as usual. Similarly as for
an <a href="#stream">input stream file</a>, this item is not part of
the ordinary syntax of MolScript. Instead it can be seen as a way to 
change the input source, basically in the same way as the input stream
feature. When the end of the macro has been reached, the input is
resumed from after the macro call. Macros may call each other, and may
also change input stream files. 
<p>
As an example, here are two fragments of input files which would
produce identical results:
<pre>
! ----- variant 1, without macro -----

     cpk either require in type ALA and atom CB,
                require in type THR and atom CG2,
                require in type VAL and atom CG*,
                require in type ILE and either atom CD1 or atom CG2,
                require in type LEU and atom CD*
             or require in type MET and atom CE;


! ----- variant 2, with macro -----

     macro methyl-sel
         either require in type ALA and atom CB,
                require in type THR and atom CG2,
                require in type VAL and atom CG*,
                require in type ILE and either atom CD1 or atom CG2,
                require in type LEU and atom CD*
             or require in type MET and atom CE
     end_macro;

     cpk $methyl-sel;
</pre>
Note that the semi-colon ';' character is left out in the
macro. Instead, it is added after the macro call. The reason for this 
is that the 'methyl-sel' macro can then be used as a part of some
other selection expression. 
<p>
It may be useful to store the definitions of commonly used macros in
separate input stream files, which may be read in at the top of
MolScript input files which use them. For instance, libraries of
reusable macros for commonly used residue or atom selections may be
created. 
<p>

<hr>
<a href="molscript.html">Top page</a>
</body>
</html>
